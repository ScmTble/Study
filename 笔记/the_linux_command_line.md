《linux 命令行大全》笔记

只记录未掌握的部分





### 目录

| 目录           | 内容                                                         |
| -------------- | ------------------------------------------------------------ |
| /              | 根目录                                                       |
| /bin           | 包含系统启动和运行的必要文件：linux内核、最初的RAM磁盘镜像和启动加载程序 |
| /boot          | /boot/gurb/gurb.conf 或 menu.lsit，用来配置启动加载程序；/boot/vmlinuz linux内核 |
| /dev           | 设备文件                                                     |
| /etc           | /etc/crontab，该文件定义了自动化任务运行的时间      /etc/fstab，存储设备以及相关挂载点的列表    /etc/passwd，用户帐号列表 |
| /home          | 普通用户目录                                                 |
| /lib           | 包含核心系统程序使用的共享文件                               |
| /lost+found    | 当系统崩溃时，该目录用来恢复分区。如果不出想很严重的问题，文件一般都是空的 |
| /media         | 包含可移除设备的挂载点                                       |
| /mnt           | 早期linux中，包含手动挂载的可移除设备的挂载点                |
| /opt           | 用来安装其他可选软件。主要用来肯安装在系统的商业软件         |
| /proc          | 从文件角度说，该目录不是存储在硬盘中的真正的文件系统，反而是一个linux内核维护的虚拟文件系统。它包含的文件是内核的窥视孔。该文件可读，从内部可以看到内核是如何监管计算机的 |
| /root          | root 用户的主目录                                            |
| /sbin          | “系统”二进制文件，这些程序执行很重要的任务，通常是为超级用户预留的 |
| /tmp           | 供用户存放各类程序创建的临时文件的目录，每次系统重启会清空该目录 |
| /usr           | /usr 目录可能是linux系统中的最大的树目录，包含普通用户使用的所有程序和相关文件 |
| /usr/bin       | 一些linux发行版安装的可执行程序。该目录通常会有上万个程序    |
| /usr/lib       | 程序使用的共享库                                             |
| /usr/local     | 这个目录并非自带的，但打算让系统使用的程序安装目录。源码编译的程序通常安装在/usr/local/bin |
| /usr/sbin      | 包含更多的系统管理程序                                       |
| /usr/share     | 包含了/usr/bin中的程序使用的全部共享数据，包括默认配置、文件、图标、屏幕背景、音频文件等 |
| /usr/share/doc | 安装的文档文件                                               |
| /var           | 除了/tmp和/home目录外，目前看到的目录都是相对静态的。而那些可能改变的数据存储在/var目录树里。各种数据库、假脱机文件、用户邮件都存储在这里 |
| /var/log       | 日志文件，记录了各种系统活动。                               |





### 通配符

| 通配符        | 匹配项                           |
| ------------- | -------------------------------- |
| *             | 匹配任意多个字符(包括0和1)       |
| ?             | 匹配任一个单字符(不包括0)        |
| [characters]  | 匹配任一个属于字符集中的字符     |
| [!characters] | 匹配任一个不属于字符集中的字符   |
| [[:class:]]   | 匹配任一个属于指定字符类中的字符 |

以下是常用的字符类

| 字符类    | 匹配项               |
| --------- | -------------------- |
| [:alnum:] | 匹配任意一个字母数字 |
| [:alpha:] | 匹配任意一个字母     |
| [:digit:] | 匹配任意一个数字     |
| [:lower:] | 匹配任意一个大写字母 |
| [:upper:] | 匹配任意一个小写字母 |





### 链接

- 创建硬链接

  ```shell
  ln file link
  ```

- 创建符号链接 (item == file / directory)

  ```shell
  ln -s item link
  ```

#### 硬链接

​	硬链接是最初UNIX系统创建链接的方式，符号链接更加先进。默认情况下，每个文件都有一个硬链接，硬链接会给文件取名字，当创建硬链接的时候也为这个文件创建了一个额外的目录条目。硬链接有两个重要的局限性：

- 硬链接不能引用文件系统之外的文件。也就是不能引用与该链接不再同一磁盘分区的文件。
- 硬链接无法引用目录

#### 符号链接

> lrwxrwxrwx 1 root root

​	l 代表软链接(symlink)，如果是 d 代表是文件夹，没有就是文件。软链接就是使一个程序有多个名字，这样文件名可以加上版本号，但不用考虑升级后调用该文件的程序更新调用名称。



### 手册

#### man手册结构

| 部分 | 内容                           |
| ---- | ------------------------------ |
| 1    | 用户命令                       |
| 2    | 内核系统调用的程序接口         |
| 3    | C库函数程序接口                |
| 4    | 特殊文件、如设备节点和驱动程序 |
| 5    | 文件格式                       |
| 6    | 游戏和娱乐，例如屏幕保护程序   |
| 7    | 其他杂项                       |
| 8    | 系统管理命令                   |

```shell
man 1 ls
```





### 重定向

- 普通重定向

  ```shell
  ls -l /etc > ls-etc.txt 
  ```

- 错误重定向

  ```shell
  ls -l /666 2> err.conf
  ```

0 代表输入文件，1 代表输出文件，2 代表错误输出文件。可以将错误重定向到位桶中来抑制错误信息。



#### 位桶(bit bucket)

/dev/null 是一个被成为位桶的设备，它接受输入但是不对输入进行任何处理。可以用来隐藏一个命令的错误信息。



#### 标准输入重定向

cat 合并文件，cat 读取一个或多个文件，并把他们复制到标准输出文件中。

例如有些多媒体文件经常被拆分，可以用cat还原为原文件

```shell
cat movie.mepg.001 move.mepg.002 ... movie.mepg.009 > movie.mpeg
```

这样来接受标准输入(输出文件内容)

```shell
cat < file
```



#### 管道

管道 | (竖线)，可以把一个命令的标准输出传入到另一个命令里面

```shell
command | command
```



#### 过滤器

```shell
ls /bin /usr/bin | sort | less
```

管道可以对数据进行复杂操作，多条命令结合在一起被称为过滤器(filter)



#### uniq 报告或忽略文件中重复的行

uniq命令一般结合 sort 命令使用，可删去重复行

```shell
ls /bin /usr/bin | sort | uniq | less
```

还可以只看重复的内容

```shell
ls /bin /usr/bin | sort | uniq -d | less
```



#### wc 打印行数、字数和字节数

字数统计(word count)用来先生文件中包含的行数字数和字节数

```shell
wc file
```



#### grep 打印匹配行

```shell
grep pattern [file...]
```



#### head / tail 打印文件的开头 / 结尾部分

```shell
head -n 5 file
```

````shell
tail -n 5 file
````

这些命令也可以用在管道里

```shell
ls /usr/bin | tail -n 8
```

tail 命令有个功能可以用来监视正在被写入的文件

```shell
tail -f /var/log/messages
```



#### tee 从stdin读取数据，并输出到stdout 和 文件

```shell
ls /usr/bin | tee s.txt | grep zip
```



### 扩展

将字符序列（比如*）处理成结果的过程被称为扩展(expansion)

#### 路径名扩展

通过使用通配符扩展路径名叫做路径名扩展(pathname expansion)

```shell
echo *
echo D*
echo [[:upper:]]*
```

#### 隐藏文件的路径名扩展

```shell
ls -d .[!.]?*
```

点代表以点开头，感叹号代表不匹配点，问好代表至少匹配一个符号，星号则代表可以匹配更多

#### 波浪线扩展

～ 代表用户目录

```shell
echo ~
```

如果有user用户

```shell
echo ~user
```

#### 算术扩展

```shell
echo $((2+3))
```

算数扩展如下格式

```shell
((expression))
```

expression 为算数表达式

| 运算符 | 描述 |
| ------ | ---- |
| +      | 加   |
| -      | 减   |
| *      | 乘   |
| /      | 除   |
| %      | 取余 |
| **     | 取幂 |

#### 花括号扩展

花括号扩展(brace expansion)可能是最奇怪的扩展方式了，有了花括号里面的模式创建多种文本字符串

```shell
echo Front-{A,B,C}-Back
```

花括号扩展的信息模式可以包括一个称为**前导字符**(**preamble**)的开头部分和一个称为**附言**(**postscript**)的结尾部分。花括号表达式本身可以包含一系列逗号分隔符的字符串，也可以包含一系列整数或者单个字符

```shell
echo Number-{1..10}
```

一系列字母

```shell
echo {Z..A}
```

花括号扩展支持嵌套

```shell
echo a{A{1,2}, B{3,4}}
```

花括号扩展可用于创建一堆文件(2015到2020每月一份文件夹)

```shell
mkdir {2015..2020}-0{1..9} {2015..2020}-{10..12}
```





#### 参数扩展

使用 printenv 命令来查看参数列表

```shell
printenv | less
```

例如用户变量

```shell
echo $USER
```

shell 

```shell
echo $SHELL
```





#### 命令替换

命令替换把一个命令的输出作为一个扩展模式使用

```shell
echo $(ls)
```

还有更好的用法

```shell
ls -l $(which cp)
```

这里将 which cp 作为 ls 命令的参数使用







### 引用

先看个例子

```shell
echo Total is $100.00
```

> (bash)	Total is 00.00
>
> (zsh)	Totoal is .00

由于 $1 是一个未定义的变量，所以参数扩展将其替换为空白字符，不同的 shell 的处理方式会有些不同

为了避免不想要的扩展，shell 提供了一种称为引用(quoting)的机制





#### 双引号

双引号引用(double quote)可以使单词扩展、路径名扩展、波浪线扩展和花括号扩展都失效，但不会使命令扩展和算数扩展失效。

空格、制表符和换行符会被当成单词的分割符，将其分为不同的参数，而加了双引号后这些符号就成了文本的一部分

````shell
echo "This is a test."
````



#### 单引号

如果希望抑制所有的扩展，那就要使用单引导

```shell
echo '$USER' 
```

> $USER



#### 转义字符

如果只想要引用单个字符，可以在该字符前加上反写杠来实现

```shell
echo \$5.00
```

转义字符也可以用来消除某个字符的特殊含义(例如 $ ! &)

```shell
echo A\&B
```

如果要显示反斜杠可以使用两个反斜杠来实现

```shell
echo \\
```









### Bash组合键

- 光标移动

  | 组合键 | 作用                 |
  | ------ | -------------------- |
  | Ctrl-A | 移动光标到行首       |
  | Ctrl-E | 移动光标到行末       |
  | Ctrl-F | 光标向前移动一个字符 |
  | Ctrl-B | 光标向后移动一个字符 |
  | Ctrl-L | 清屏                 |
  | Alt-F  | 光标向前移动一个单词 |
  | Alt-B  | 光标向后移动一个单词 |

- 修改文本

  | 组合键 | 作用                             |
  | ------ | -------------------------------- |
  | Ctrl-D | 删除光标处的字符                 |
  | Ctrl-T | 使光标处字符和它前面字符对调位置 |
  | Alt-T  | 使光标处字符和它后面字符对调位置 |
  | Alt-L  | 把光标到末尾的字符换成小写模式   |
  | Alt-U  | 把光标到末尾的字符换成大写模式   |

- 剪切和粘贴文本(Killing and Yanking)

  | 组合键        | 作用                                    |
  | ------------- | --------------------------------------- |
  | Ctrl-K        | 剪切从光标到末尾的文本                  |
  | Ctrl-U        | 剪切从光标到行首的文本                  |
  | Alt-D         | 剪切从光标到当前词尾的文本              |
  | Alt-Backspace | 剪切从光标到词头的文本                  |
  | Ctrl-Y        | 把 kill-ring 缓冲区的文本粘贴到光标位置 |

